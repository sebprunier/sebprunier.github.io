---
layout: post
title: Pimp My Bonita - Les astuces du jour - n°1
date: 2012-02-24 18:51:48.000000000 +01:00
categories:
- Communautés
- Fun
- Tutoriels
tags:
- Bonita
- BPM
- groovy
- PimpMyBonita
status: publish
type: post
published: true
meta:
  _edit_last: '24226490'
  _oembed_004f968f2ec8249f5245858d18e32eb7: "{{unknown}}"
  _oembed_94cbf71dd55f7b978f4228b550090c73: "{{unknown}}"
author: 
---
<p>J'occupe actuellement mes heures perdues avec le challenge "<a href="http://www.bonitasoft.org/blog/contests/pimp-my-bonita/" target="_blank">Pimp My Bonita</a>" !</p>
<p>C'est l'occasion d'alimenter mon blog avec quelques astuces que j'ai utilisées dans le cadre du challenge.</p>
<p>Menu du jour :</p>
<ul>
<li>Récupérer la liste des utilisateurs d'un groupe</li>
<li>Exécution de tâches conditionnelles en parallèle</li>
</ul>
<p>J'espère avoir assez de temps pour proposer les fruits de mon travail. Rendez-vous au plus tard le 15 mars pour plus de détails !</p>
<p><a href="http://sebprunier.files.wordpress.com/2012/02/pimp-my-bonita.gif"><img class="aligncenter size-full wp-image-326" title="pimp-my-bonita" src="assets/pimp-my-bonita.gif" alt="" width="255" height="45" /></a></p>
<p><!--more--></p>
<h2>Récupérer la liste des utilisateurs d'un groupe</h2>
<p>L'objectif est de pouvoir alimenter une combobox avec la liste des utilisateurs d'un groupe.</p>
<p>Rien de plus simple, grâce à un connecteur Groovy et à l'IdentityAPI de Bonita :</p>
<p>[sourcecode language="groovy"]<br />
import org.ow2.bonita.facade.identity.User;</p>
<p>import org.ow2.bonita.facade.identity.Group;<br />
import org.ow2.bonita.facade.identity.Role;<br />
import org.ow2.bonita.facade.IdentityAPI;</p>
<p>// Get IdentityAPI<br />
IdentityAPI identityAPI = apiAccessor.getIdentityAPI()</p>
<p>// Use IdentityAPI to get the ORDERERS group (platform/ORDERERS)<br />
Group ordererGroup = identityAPI.getGroupUsingPath([&quot;platform&quot;, &quot;ORDERERS&quot;])</p>
<p>// Get the list of orderers !<br />
List&lt;User&gt; orderersList = identityAPI.getAllUsersInGroup(ordererGroup.getUUID())</p>
<p>// Fill the map with the list content<br />
Map&lt;String, String&gt; orderersMap = [:]<br />
orderersList.each {<br />
 orderersMap.put(it.getUsername(), it.getUUID())<br />
}<br />
return orderersMap<br />
[/sourcecode]</p>
<p>La Map retournée par le script Groovy est ensuite stockée dans une variable de processus de type Java Object (java.util.Map), qui sera utilisée au niveau du formulaire pour alimenter les données de la combobox.</p>
<p><a href="http://sebprunier.files.wordpress.com/2012/02/orderers-list.png"><img class="aligncenter size-full wp-image-332" title="orderers-list" src="assets/orderers-list.png" alt="" width="443" height="83" /></a></p>
<p>Pour info, le HTML généré est le suivant :</p>
<p>[sourcecode language="html"]<br />
&lt;select&gt;<br />
    &lt;option value=&quot;502990d4-fad1-4d8f-82f6-f5df1c48b506&quot;&gt;orderer1&lt;/option&gt;<br />
    &lt;option value=&quot;4b36d8b8-c694-4e8d-988d-e13817856f3e&quot;&gt;orderer2&lt;/option&gt;<br />
&lt;/select&gt;<br />
[/sourcecode]</p>
<p>Le fait d'utiliser une Map permet d'avoir des valeurs différentes pour les labels et values des &lt;option&gt; du &lt;select&gt; HTML.</p>
<p>J'ai d'ailleurs contribué un exemple à ce sujet : <a href="http://www.bonitasoft.org/exchange/extension_view.php?eid=285">http://www.bonitasoft.org/exchange/extension_view.php?eid=285</a></p>
<h2>Exécution de taches conditionnelles en parallèle</h2>
<p>La problématique est la suivante :</p>
<ul>
<li>Un utilisateur saisit une demande. Dans la saisie, il précise s'il y a un impact ou non en terme de sécurité.</li>
<li>S'il y a un impact, des consignes de sécurité doivent être saisies.</li>
<li>La réalisation de la demande et la saisie des consignes sont exécutées en parallèle (par des personnes de groupes différents)</li>
<li>La demande ne peut être clôturée que si la saisie de l'impact a été faite (s'il y avait un impact bien entendu)</li>
</ul>
<p>Voici une façon de faire, à l'aide de portes AND et XOR :</p>
<p><a href="http://sebprunier.files.wordpress.com/2012/02/executionconditionnelleparallele_1-0.png"><img class="aligncenter size-full wp-image-335" title="ExecutionConditionnelleParallele_1.0" src="assets/executionconditionnelleparallele_1-0.png" alt="" width="630" height="223" /></a></p>
<h2>Conclusion</h2>
<p>Suite au prochain épisode ! :-)</p>
